(()=>{"use strict";var r=new(function(){function r(){this.vigenereKeyRegex=/[a-zA-Z]/gm,this.keyRegex=/(?!^[0-9]*$)(?!^[a-zA-Z]*$)^([a-zA-Z0-9]{6,})$/gm}return r.prototype.isLetter=function(r){return 1===r.length&&r.match(/[a-zA-Z]/i)},r.prototype.randomString=function(r){for(var t="",e=0;e<r;)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random())),e+=1;return t},r.prototype.randomLetter=function(r){for(var t="",e=0;e<r;)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(52*Math.random())),e+=1;return t},r.prototype.randomInt=function(r,t){return r=Math.ceil(r),t=Math.floor(t),Math.floor(Math.random()*(t-r+1))+r},r.prototype.isUpperCase=function(r){return r===r.toUpperCase()},r.prototype.rowFenceEncrypt=function(r,t){t=t>1?t:2;for(var e=r.length,n=r.split(""),o=[],a=0;a<t;a++)o[a]=[];for(var i=0;i<t;i++)for(var h=0;h<Math.ceil(e/t);h++){var c=n[t*h+i];o[i].push(c||"=")}return o.map((function(r){return r.join("")})).join("")},r.prototype.rowFenceDecrypt=function(r,t){try{t=t>1?t:2;for(var e=r.length,n=r.split(""),o=Math.round(e/t),a=[],i=[],h=0;h<t;h++)for(var c=0;c<o;c++){a[h]||(a[h]=[]);var p=h*o+c;a[h].push(n[p])}for(var s=function(r){i[r]=a.map((function(t){return t[r]}))},u=0;u<o;u++)s(u);for(var f=i.map((function(r){return r.join("")})).join(""),y=[],m=f.length;m>0;m--){var d=f[m-1];"="!==d&&y.push(d)}return y.reverse().join("")}catch(t){return r}},r.prototype.vigenereEncrypt=function(r,t){for(var e="",n=0,o=0;n<r.length;n++){var a=r.charAt(n);this.isLetter(a)?this.isUpperCase(a)?e+=String.fromCharCode((a.charCodeAt(0)+t.toUpperCase().charCodeAt(o)-130)%26+65):e+=String.fromCharCode((a.charCodeAt(0)+t.toLowerCase().charCodeAt(o)-194)%26+97):e+=a,o=++o%t.length}return e},r.prototype.vigenereDecrypt=function(r,t){try{for(var e="",n=0,o=0;n<r.length;n++){var a=r.charAt(n);this.isLetter(a)?this.isUpperCase(a)?e+=String.fromCharCode(90-(25-(a.charCodeAt(0)-t.toUpperCase().charCodeAt(o)))%26):e+=String.fromCharCode(122-(25-(a.charCodeAt(0)-t.toLowerCase().charCodeAt(o)))%26):e+=a,o=++o%t.length}return e}catch(t){return r}},r.prototype.encrypt=function(r,t,e){void 0===e&&(e="");try{var n=t+e;if(!n)throw new Error("Key must not be empty");if(null===n.match(this.keyRegex))throw new Error("Key must contain number and letter (a-z, A-Z) and must be more than 6 characters");if(isNaN(parseInt(n[0])))throw new Error("First character of key must be in number");var o=encodeURI(r),a=btoa(o),i=this.vigenereEncrypt(a,n.match(this.vigenereKeyRegex).join(""));return this.rowFenceEncrypt(i,parseInt(n[0]))}catch(r){return console.warn(r),null}},r.prototype.decrypt=function(r,t,e){void 0===e&&(e="");try{var n=t+e;if(!n)throw new Error("Key must not be empty");if(null===n.match(this.keyRegex))throw new Error("Key must contain number and letter (a-z, A-Z) and must be more than 6 characters");if(isNaN(parseInt(n[0])))throw new Error("First character of key must be in number");var o=this.rowFenceDecrypt(r,parseInt(n[0])),a=this.vigenereDecrypt(o,n.match(this.vigenereKeyRegex).join("")),i=atob(a);return decodeURI(i)}catch(r){return console.warn(r),null}},r.prototype.generateMasterKey=function(){return this.randomInt(0,9)+this.randomLetter(1)+this.randomString(14)},r.prototype.generatePersonalKey=function(){return this.randomString(16)},r}());window.E2EE=r})();